import{d as L,c as l,b as e,e as c,t as v,h as s,r as m,a as H,o as P,G as R,C as O,H as k,y as D,F as I,f as $,z as G,A as X,w as j,n as M,D as q,i as V,v as E,j as J,p as K,u as Q,I as W,_ as Y}from"./index-Tqr-62Ja.js";import{_ as Z}from"./PageHeader.vue_vue_type_script_setup_true_lang-CbEQsKCn.js";const T={class:"bg-white shadow-lg rounded-lg overflow-hidden transition-all duration-300 hover:shadow-xl relative group flex flex-col border border-transparent hover:border-[var(--dream-main)]"},ee={class:"p-5 flex-grow flex flex-col"},te=["src","alt"],ae={key:1,class:"w-full h-40 bg-[var(--dream-gray)] rounded-md mb-4 flex items-center justify-center text-[var(--dream-sub)]"},se=["data-id"],le={class:"text-sm text-[var(--dream-sub)] leading-relaxed whitespace-pre-line flex-grow"},oe={key:0,class:"absolute top-2 right-2 flex flex-col space-y-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200"},re=L({__name:"LectureSubItemCard",props:{subItem:{},isStaff:{type:Boolean}},emits:["edit","delete"],setup(U,{emit:C}){return(n,o)=>(s(),l("li",T,[e("div",ee,[n.subItem.image?(s(),l("img",{key:0,src:n.subItem.image,alt:n.subItem.title,class:"w-full h-40 object-cover rounded-md mb-4"},null,8,te)):(s(),l("div",ae,o[2]||(o[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)]))),e("h2",{class:"text-lg font-semibold text-[var(--dream-text)] mb-2 group-hover:text-[var(--dream-main)]","data-id":n.subItem.id},v(n.subItem.title),9,se),e("p",le,v(n.subItem.contents),1)]),n.isStaff?(s(),l("div",oe,[e("button",{onClick:o[0]||(o[0]=i=>n.$emit("edit",n.subItem)),class:"bg-[var(--dream-blue)] hover:bg-opacity-80 text-white text-xs font-semibold py-1 px-2 rounded-md shadow-sm"},"수정"),e("button",{onClick:o[1]||(o[1]=i=>n.$emit("delete",n.subItem.id)),class:"bg-red-500 hover:bg-red-600 text-white text-xs font-semibold py-1 px-2 rounded-md shadow-sm"},"삭제")])):c("",!0)]))}}),ne={class:"font-[var(--font-body)]"},ie={class:"container mx-auto px-4 sm:px-6 lg:px-8 py-12"},de={key:0},ue={class:"text-3xl font-bold text-center mb-4 text-[var(--dream-text)]"},me={key:0,class:"text-center text-lg text-[var(--dream-sub)] mb-10"},ce={key:1,class:"text-right mb-6"},ve={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},pe={key:3,class:"text-center text-gray-500 py-8"},be={key:0,class:"mt-2 text-sm"},xe={key:1,class:"text-center text-gray-500 py-16"},ge={class:"flex justify-between items-center mb-6"},fe={class:"text-xl font-semibold text-[var(--dream-text)]"},he={class:"space-y-4"},ye={key:0},_e=["for"],we=["type","id","onUpdate:modelValue"],ke=["id","onUpdate:modelValue"],Ie={key:1},Ce={class:"block text-sm font-medium text-[var(--dream-sub)] mb-1"},Se={class:"mt-1 w-full flex flex-col items-center px-4 py-3 bg-white text-[var(--dream-blue)] rounded-lg shadow border border-[var(--dream-blue)] border-dashed cursor-pointer hover:bg-[var(--dream-gray)] hover:text-[var(--dream-main)] transition-colors"},De={class:"mt-1 text-xs leading-normal"},$e=["id"],je={key:0,class:"mt-3 text-center"},Me={class:"border border-gray-300 p-2 rounded-md w-full max-w-xs h-40 mx-auto flex items-center justify-center overflow-hidden relative bg-gray-50"},Ve=["src"],Le={class:"mt-8 text-right space-x-3"},Ue={type:"submit",class:"bg-[var(--dream-main)] hover:bg-opacity-80 text-white font-semibold py-2 px-4 rounded-md shadow-sm"},ze=L({__name:"LectureDetailPage",setup(U){const C=R(),n=m(Q.isStaff),o=m(null),i=m([]),b=m(!1),x=m(!1),h=m(null),w={title:"",contents:""},d=H({...w}),z=m(W),u=m(null),g=m(null);P(()=>{const r=parseInt(C.params.id,10);o.value=O.find(t=>t.id===r)||null,o.value&&(i.value=[...k[r]||[]])});const S=r=>{r?(x.value=!0,h.value=r.id,d.title=r.title,d.contents=r.contents,u.value=r.image||null):(x.value=!1,h.value=null,Object.assign(d,w),u.value=null),g.value=null,b.value=!0},_=()=>{b.value=!1,Object.assign(d,w),u.value=null,g.value=null,x.value=!1,h.value=null},B=()=>{if(!o.value)return;let r=u.value;if(g.value?r=u.value:!u.value&&x.value&&(r=null),x.value&&h.value!==null){const t=i.value.findIndex(p=>p.id===h.value);t!==-1&&(i.value[t]={...i.value[t],...d,image:r===void 0?i.value[t].image:r||void 0})}else{const t=i.value.length>0?Math.max(...i.value.map(p=>p.id))+1001:1001;i.value.push({id:t,mainLectureId:o.value.id,...d,image:r||void 0})}o.value&&(k[o.value.id]=[...i.value]),_()},F=r=>{window.confirm("정말로 이 항목을 삭제하시겠습니까?")&&(i.value=i.value.filter(t=>t.id!==r),o.value&&(k[o.value.id]=[...i.value]))},A=r=>{const t=r.target;if(t.files&&t.files[0]){const p=t.files[0];g.value=p;const y=new FileReader;y.onload=a=>{var f;u.value=(f=a.target)==null?void 0:f.result},y.readAsDataURL(p),t.value=""}},N=()=>{u.value=null,g.value=null};return(r,t)=>{var y;const p=X("router-link");return s(),l("div",ne,[D(Z,{title:((y=o.value)==null?void 0:y.title)||"강의 상세",backgroundImageUrl:"/Dreamseekers-FE/img/top_header/lecture.jpg"},null,8,["title"]),e("div",ie,[o.value?(s(),l("div",de,[e("h1",ue,v(o.value.title),1),o.value.contents?(s(),l("p",me,v(o.value.contents),1)):c("",!0),n.value?(s(),l("div",ce,[e("button",{onClick:t[0]||(t[0]=a=>S()),class:"bg-[var(--dream-main)] hover:bg-opacity-80 text-white font-semibold py-2 px-6 rounded-md shadow-sm"},"세부 항목 추가")])):c("",!0),i.value.length>0?(s(),l("ul",ve,[(s(!0),l(I,null,$(i.value,a=>(s(),q(re,{key:a.id,"sub-item":a,"is-staff":n.value,onEdit:S,onDelete:F},null,8,["sub-item","is-staff"]))),128))])):(s(),l("div",pe,[t[1]||(t[1]=e("p",null,"표시할 세부 강의 항목이 없습니다.",-1)),n.value?(s(),l("p",be,'"세부 항목 추가" 버튼을 눌러 내용을 추가할 수 있습니다.')):c("",!0)]))])):(s(),l("div",xe,[t[3]||(t[3]=e("p",null,"강의 정보를 불러올 수 없습니다.",-1)),D(p,{to:"/lectures",class:"text-[var(--dream-main)] hover:underline mt-4 inline-block"},{default:G(()=>t[2]||(t[2]=[K("강의 목록으로 돌아가기")])),_:1,__:[2]})])),t[6]||(t[6]=e("div",{class:"mt-12 border-t border-[var(--dream-gray-dark)] opacity-30"},null,-1)),n.value&&b.value?(s(),l("div",{key:2,class:M(["fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4",{"opacity-100":b.value,"opacity-0 pointer-events-none":!b.value}]),onClick:j(_,["self"])},[e("div",{class:M(["bg-white p-6 sm:p-8 rounded-lg shadow-2xl w-full max-w-lg transform transition-all duration-300 ease-in-out",{"scale-100":b.value,"scale-95":!b.value}])},[e("div",ge,[e("h3",fe,v(x.value?"세부 항목 수정":"새 세부 항목 추가"),1),e("button",{onClick:_,class:"text-gray-400 hover:text-gray-600 text-2xl leading-none"},"×")]),e("form",{onSubmit:j(B,["prevent"])},[e("div",he,[(s(!0),l(I,null,$(z.value,a=>(s(),l(I,{key:a.name},[a.type==="text"||a.type==="textarea"?(s(),l("div",ye,[e("label",{for:a.id,class:"block text-sm font-medium text-[var(--dream-sub)] mb-1"},v(a.label),9,_e),a.type==="text"?V((s(),l("input",{key:0,type:a.type,id:a.id,"onUpdate:modelValue":f=>d[a.name]=f,class:"mt-1 block w-full px-3 py-2 border border-[var(--dream-gray-dark)] rounded-md shadow-sm focus:outline-none focus:ring-[var(--dream-main)] focus:border-[var(--dream-main)] sm:text-sm"},null,8,we)),[[E,d[a.name]]]):a.type==="textarea"?V((s(),l("textarea",{key:1,id:a.id,"onUpdate:modelValue":f=>d[a.name]=f,rows:"4",class:"mt-1 block w-full px-3 py-2 border border-[var(--dream-gray-dark)] rounded-md shadow-sm focus:outline-none focus:ring-[var(--dream-main)] focus:border-[var(--dream-main)] sm:text-sm resize-none"},null,8,ke)),[[J,d[a.name]]]):c("",!0)])):c("",!0),a.type==="image"?(s(),l("div",Ie,[e("label",Ce,v(a.label),1),e("label",Se,[t[4]||(t[4]=e("svg",{class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M16.88 9.1A4 4 0 0 1 16 17H5a5 5 0 0 1-1-9.9V7a3 3 0 0 1 4.52-2.59A4.98 4.98 0 0 1 17 8c0 .38-.04.74-.12 1.1zM11 11h3l-4-4-4 4h3v3h2v-3z"})],-1)),e("span",De,v(g.value?g.value.name:"이미지 선택 (선택 사항)"),1),e("input",{id:a.id,type:"file",accept:"image/*",class:"hidden",onChange:A},null,40,$e)]),u.value?(s(),l("div",je,[t[5]||(t[5]=e("p",{class:"text-xs font-medium text-[var(--dream-sub)] mb-1"},"미리보기",-1)),e("div",Me,[e("img",{src:u.value,alt:"이미지 미리보기",class:"max-h-full max-w-full object-contain rounded"},null,8,Ve),e("button",{type:"button",onClick:N,class:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-0.5 w-5 h-5 flex items-center justify-center text-xs leading-none hover:bg-red-600",title:"이미지 제거"}," X ")])])):c("",!0)])):c("",!0)],64))),128))]),e("div",Le,[e("button",{type:"button",onClick:_,class:"bg-[var(--dream-gray-dark)] hover:bg-opacity-80 text-white font-semibold py-2 px-4 rounded-md shadow-sm"},"취소"),e("button",Ue,v(x.value?"수정 완료":"등록"),1)])],32)],2)],2)):c("",!0)])])}}}),Ae=Y(ze,[["__scopeId","data-v-b8a141e7"]]);export{Ae as default};
